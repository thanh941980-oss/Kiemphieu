<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Kiểm phiếu - Đăng nhập</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }

        body {
            background: linear-gradient(135deg, #6a11cb 0%, #2575fc 100%);
            height: 100vh;
            display: flex;
            justify-content: center;
            align-items: center;
        }

        .container {
            width: 100%;
            max-width: 400px;
            padding: 20px;
        }

        .form-container {
            background-color: white;
            border-radius: 10px;
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.2);
            padding: 30px;
            transition: all 0.3s ease;
        }

        .logo {
            text-align: center;
            margin-bottom: 20px;
        }

        .logo h1 {
            color: #2575fc;
            font-size: 28px;
            margin-bottom: 5px;
        }

        .logo p {
            color: #666;
            font-size: 14px;
        }

        .form-group {
            margin-bottom: 20px;
        }

        .form-group label {
            display: block;
            margin-bottom: 8px;
            color: #333;
            font-weight: 500;
        }

        .form-group input {
            width: 100%;
            padding: 12px 15px;
            border: 1px solid #ddd;
            border-radius: 5px;
            font-size: 16px;
            transition: border 0.3s;
        }

        .form-group input:focus {
            border-color: #2575fc;
            outline: none;
        }

        .btn {
            width: 100%;
            padding: 12px;
            background: linear-gradient(135deg, #6a11cb 0%, #2575fc 100%);
            color: white;
            border: none;
            border-radius: 5px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
        }

        .btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.2);
        }

        .toggle-form {
            text-align: center;
            margin-top: 20px;
            font-size: 14px;
        }

        .toggle-form a {
            color: #2575fc;
            text-decoration: none;
            font-weight: 500;
            cursor: pointer;
        }

        .toggle-form a:hover {
            text-decoration: underline;
        }

        .message {
            padding: 10px;
            margin-bottom: 15px;
            border-radius: 5px;
            text-align: center;
            display: none;
        }

        .success {
            background-color: #d4edda;
            color: #155724;
            border: 1px solid #c3e6cb;
        }

        .error {
            background-color: #f8d7da;
            color: #721c24;
            border: 1px solid #f5c6cb;
        }

        .hidden {
            display: none;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="form-container" id="login-container">
            <div class="logo">
                <h1>Kiểm phiếu</h1>
                <p>Đăng nhập vào tài khoản của bạn</p>
            </div>
            
            <div id="message" class="message"></div>
            
            <form id="login-form">
                <div class="form-group">
                    <label for="login-email">Email</label>
                    <input type="email" id="login-email" required>
                </div>
                <div class="form-group">
                    <label for="login-password">Mật khẩu</label>
                    <input type="password" id="login-password" required>
                </div>
                <button type="submit" class="btn">Đăng nhập</button>
            </form>
            
            <div class="toggle-form">
                Chưa có tài khoản? <a id="show-register">Đăng ký ngay</a>
            </div>
        </div>
        
        <div class="form-container hidden" id="register-container">
            <div class="logo">
                <h1>Kiểm phiếu</h1>
                <p>Tạo tài khoản mới</p>
            </div>
            
            <div id="register-message" class="message"></div>
            
            <form id="register-form">
                <div class="form-group">
                    <label for="register-name">Họ và tên</label>
                    <input type="text" id="register-name" required>
                </div>
                <div class="form-group">
                    <label for="register-email">Email</label>
                    <input type="email" id="register-email" required>
                </div>
                <div class="form-group">
                    <label for="register-password">Mật khẩu</label>
                    <input type="password" id="register-password" minlength="6" required>
                </div>
                <div class="form-group">
                    <label for="confirm-password">Xác nhận mật khẩu</label>
                    <input type="password" id="confirm-password" minlength="6" required>
                </div>
                <button type="submit" class="btn">Đăng ký</button>
            </form>
            
            <div class="toggle-form">
                Đã có tài khoản? <a id="show-login">Đăng nhập</a>
            </div>
        </div>
    </div>

    <!-- Firebase SDK -->
    <script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-auth-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-database-compat.js"></script>
    
    <script>
        // Firebase configuration
        const firebaseConfig = { 
  apiKey : "AIzaSyAt-OooTscmthbJXNcvy80RgPDA9T46-0w" , 
  authDomain : "kiemphieu-45823.firebaseapp.com" , 
  databaseURL : "https://kiemphieu-45823-default-rtdb.asia-southeast1.firebasedatabase.app" , 
  projectId : "kiemphieu-45823" , 
  storageBucket : "kiemphieu-45823.firebasestorage.app" , 
  messagingSenderId : "908329514571" , 
  appId : "1:908329514571:web:16b43df5b795e4de06bfce" 
};
        // Initialize Firebase
        firebase.initializeApp(firebaseConfig);
        const auth = firebase.auth();
        const database = firebase.database();

        // DOM Elements
        const loginContainer = document.getElementById('login-container');
        const registerContainer = document.getElementById('register-container');
        const loginForm = document.getElementById('login-form');
        const registerForm = document.getElementById('register-form');
        const showRegister = document.getElementById('show-register');
        const showLogin = document.getElementById('show-login');
        const messageDiv = document.getElementById('message');
        const registerMessageDiv = document.getElementById('register-message');

        // Toggle between login and register forms
        showRegister.addEventListener('click', () => {
            loginContainer.classList.add('hidden');
            registerContainer.classList.remove('hidden');
        });

        showLogin.addEventListener('click', () => {
            registerContainer.classList.add('hidden');
            loginContainer.classList.remove('hidden');
        });

        // Login function
        Gemini

2.5 Flash

Trò chuyện với Gemini

index
HTML

Lưu không được kiểm tra và chỉnh rules để lưu trữ mỗi user dữ liệu riêng





Phân tích
Được rồi. Để đảm bảo mỗi người dùng có thể lưu trữ dữ liệu riêng tư của họ một cách an toàn và ngăn người khác truy cập, bạn cần điều chỉnh các quy tắc bảo mật (security rules) của Firebase Realtime Database.

1. Mở Security Rules
Đầu tiên, bạn cần truy cập vào bảng điều khiển Firebase (Firebase Console) của dự án.

Mở dự án Firebase của bạn.

Từ menu bên trái, chọn Realtime Database.

Chọn tab Rules.

2. Thiết lập quy tắc cho dữ liệu người dùng
Khi ở trong tab Rules, bạn sẽ thấy các quy tắc hiện tại của mình. Dựa trên cấu trúc code của bạn, dữ liệu người dùng được lưu trữ trong một node có tên là users/ và sau đó là ID người dùng (uid).
Bạn nên thay thế các quy tắc mặc định bằng các quy tắc sau:

JSON

{
  "rules": {
    "users": {
      "$uid": {
        ".read": "auth != null && auth.uid == $uid",
        ".write": "auth != null && auth.uid == $uid"
      }
    }
  }
}
Sau đó, nhấp vào "Publish" để lưu các thay đổi.

3. Giải thích các quy tắc
"users": Quy tắc này áp dụng cho node chính users/ trong cơ sở dữ liệu của bạn.

"$uid": Đây là một biến wildcard. Nó đại diện cho bất kỳ chuỗi con nào nằm ngay dưới node users/. Trong trường hợp này, nó sẽ khớp với ID duy nhất của người dùng (UID).

".read": "auth != null && auth.uid == $uid":

auth != null: Kiểm tra xem người dùng có được xác thực hay không (đã đăng nhập). Nếu chưa đăng nhập, auth sẽ là null.

auth.uid == $uid: Kiểm tra xem UID của người dùng đã đăng nhập có khớp với UID trong đường dẫn dữ liệu mà họ đang cố đọc hay không. Điều này đảm bảo rằng chỉ người dùng đó mới có thể đọc dữ liệu trong thư mục UID của họ.

".write": "auth != null && auth.uid == $uid":

Tương tự như quy tắc đọc, quy tắc này đảm bảo rằng chỉ người dùng đã đăng nhập mới có thể ghi (tạo, cập nhật, xóa) dữ liệu trong thư mục UID của họ.

Những quy tắc này tạo ra một hệ thống bảo mật mạnh mẽ và chặt chẽ cho cơ sở dữ liệu của bạn, cho phép mỗi người dùng chỉ có thể truy cập và chỉnh sửa dữ liệu của riêng họ, ngăn chặn hoàn toàn việc người dùng khác có thể xem hoặc thay đổi thông tin cá nhân của người khác.


index
HTML


Nếu chưa đăng ký tài khoản thì báo chưa đăng ký tài khoản, nhập sai tên đăng nhập báo sai, nhập sai pass bái sai





Phân tích
Trong đoạn mã JavaScript của bạn, bạn đã xử lý các trường hợp lỗi đăng nhập và đăng ký. Tuy nhiên, để đáp ứng yêu cầu cụ thể của bạn, bạn cần điều chỉnh cách xử lý lỗi trong hàm loginForm.addEventListener.

Đây là cách bạn có thể sửa đổi hàm này để hiển thị thông báo chính xác cho từng loại lỗi:

JavaScript

        // Login function
        loginForm.addEventListener('submit', (e) => {
            e.preventDefault();
            
            const email = document.getElementById('login-email').value;
            const password = document.getElementById('login-password').value;
            
            auth.signInWithEmailAndPassword(email, password)
                .then((userCredential) => {
                    // Login successful
                    const user = userCredential.user;
                    showMessage('Đăng nhập thành công!', 'success');
                    
                    // Redirect to dashboard after a short delay
                    setTimeout(() => {
                        window.location.href = 'dashboard.html';
                    }, 1000);
                })
                .catch((error) => {
                    // Handle errors
                    const errorCode = error.code;
                    let errorMessage = 'Đã xảy ra lỗi khi đăng nhập.';
                    
                    if (errorCode === 'auth/user-not-found' || errorCode === 'auth/invalid-email') {
                        errorMessage = 'Tài khoản không tồn tại hoặc email không hợp lệ.';
                    } else if (errorCode === 'auth/wrong-password') {
                        errorMessage = 'Mật khẩu không chính xác.';
                    }
                    
                    showMessage(errorMessage, 'error');
                });

        // Register function
        registerForm.addEventListener('submit', (e) => {
            e.preventDefault();
            
            const name = document.getElementById('register-name').value;
            const email = document.getElementById('register-email').value;
            const password = document.getElementById('register-password').value;
            const confirmPassword = document.getElementById('confirm-password').value;
            
            // Validate passwords match
            if (password !== confirmPassword) {
                showRegisterMessage('Mật khẩu xác nhận không khớp.', 'error');
                return;
            }
            
            // Create user with Firebase Auth
            auth.createUserWithEmailAndPassword(email, password)
                .then((userCredential) => {
                    // User created successfully
                    const user = userCredential.user;
                    
                    // Save additional user data to Realtime Database
                    return database.ref('users/' + user.uid).set({
                        name: name,
                        email: email,
                        createdAt: new Date().toISOString()
                    });
                })
                .then(() => {
                    showRegisterMessage('Đăng ký thành công!', 'success');
                    
                    // Clear form
                    registerForm.reset();
                    
                    // Switch to login form after a short delay
                    setTimeout(() => {
                        registerContainer.classList.add('hidden');
                        loginContainer.classList.remove('hidden');
                    }, 1500);
                })
                .catch((error) => {
                    // Handle errors
                    const errorCode = error.code;
                    let errorMessage = 'Đã xảy ra lỗi khi đăng ký.';
                    
                    if (errorCode === 'auth/email-already-in-use') {
                        errorMessage = 'Email đã được sử dụng.';
                    } else if (errorCode === 'auth/weak-password') {
                        errorMessage = 'Mật khẩu quá yếu (tối thiểu 6 ký tự).';
                    } else if (errorCode === 'auth/invalid-email') {
                        errorMessage = 'Email không hợp lệ.';
                    }
                    
                    showRegisterMessage(errorMessage, 'error');
                });
        });

        // Helper functions to show messages
        function showMessage(text, type) {
            messageDiv.textContent = text;
            messageDiv.className = `message ${type}`;
            messageDiv.style.display = 'block';
        }

        function showRegisterMessage(text, type) {
            registerMessageDiv.textContent = text;
            registerMessageDiv.className = `message ${type}`;
            registerMessageDiv.style.display = 'block';
        }
    </script>
</body>
</html>
